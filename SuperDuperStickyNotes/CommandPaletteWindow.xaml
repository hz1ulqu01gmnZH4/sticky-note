<Window x:Class="SuperDuperStickyNotes.CommandPaletteWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Command Palette"
        Height="60"
        Width="600"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        Topmost="True"
        WindowStartupLocation="CenterScreen"
        Deactivated="Window_Deactivated"
        PreviewKeyDown="Window_PreviewKeyDown">

    <Border Background="#2C2C2C"
            CornerRadius="5"
            BorderThickness="1"
            BorderBrush="#555555">
        <Border.Effect>
            <DropShadowEffect Color="Black"
                              Direction="315"
                              ShadowDepth="5"
                              Opacity="0.5"
                              BlurRadius="10"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Input Area -->
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text=">"
                           Foreground="#00FF00"
                           VerticalAlignment="Center"
                           Margin="10,0,5,0"
                           FontFamily="Consolas"
                           FontSize="16"/>

                <TextBox Grid.Column="1"
                         x:Name="CommandInput"
                         Background="Transparent"
                         Foreground="White"
                         BorderThickness="0"
                         VerticalAlignment="Center"
                         FontFamily="Consolas"
                         FontSize="14"
                         CaretBrush="White"
                         TextChanged="CommandInput_TextChanged"
                         KeyDown="CommandInput_KeyDown"/>
            </Grid>

            <!-- Suggestions Popup -->
            <Popup x:Name="SuggestionsPopup"
                   PlacementTarget="{Binding ElementName=CommandInput}"
                   Placement="Bottom"
                   StaysOpen="False"
                   Width="580">
                <Border Background="#1E1E1E"
                        BorderThickness="1"
                        BorderBrush="#555555"
                        CornerRadius="0,0,5,5">
                    <ListBox x:Name="SuggestionsList"
                             Background="Transparent"
                             BorderThickness="0"
                             MaxHeight="200"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             SelectionChanged="SuggestionsList_SelectionChanged">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="Padding" Value="10,5"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Border x:Name="Border"
                                                    Background="Transparent"
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Border" Property="Background" Value="#3C3C3C"/>
                                                </Trigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Border" Property="Background" Value="#2C2C2C"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Icon}"
                                               Margin="0,0,10,0"
                                               FontSize="14"/>
                                    <TextBlock Text="{Binding Title}"
                                               FontWeight="Bold"
                                               Margin="0,0,10,0"/>
                                    <TextBlock Text="{Binding Description}"
                                               Foreground="#888888"
                                               FontSize="12"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
            </Popup>
        </Grid>
    </Border>
</Window>